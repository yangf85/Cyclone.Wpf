<UserControl
    x:Class="Cyclone.Wpf.Demo.Views.CascadePickerView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:cy="https://www.cyclone/wpf"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Cyclone.Wpf.Demo.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    d:DataContext="{d:DesignInstance Type=local:CascadePickerViewModel}"
    d:DesignHeight="700"
    d:DesignWidth="900"
    mc:Ignorable="d">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <cy:SpacingStackPanel Margin="20" Spacing="20">
            <!--  示例1：手动创建的级联选择器  -->
            <HeaderedContentControl Header="手动创建的级联选择器">
                <cy:SpacingUniformGrid HorizontalSpacing="10" Rows="1">
                    <cy:CascadePicker
                        IsShowFullPath="True"
                        Separator="/"
                        Watermark="请选择">
                        <cy:CascadePickerItem Header="家电">
                            <cy:CascadePickerItem Header="大家电">
                                <cy:CascadePickerItem Header="电视" />
                                <cy:CascadePickerItem Header="冰箱" />
                                <cy:CascadePickerItem Header="洗衣机" />
                                <cy:CascadePickerItem Header="空调" />
                            </cy:CascadePickerItem>
                            <cy:CascadePickerItem Header="小家电">
                                <cy:CascadePickerItem Header="电饭煲" />
                                <cy:CascadePickerItem Header="微波炉" />
                                <cy:CascadePickerItem Header="电水壶" />
                            </cy:CascadePickerItem>
                        </cy:CascadePickerItem>
                        <cy:CascadePickerItem Header="数码">
                            <cy:CascadePickerItem Header="手机" />
                            <cy:CascadePickerItem Header="相机" />
                            <cy:CascadePickerItem Header="耳机" />
                        </cy:CascadePickerItem>
                        <cy:CascadePickerItem Header="服装" />
                    </cy:CascadePicker>
                    <cy:CascadePicker
                        IsReadOnly="True"
                        IsShowFullPath="False"
                        Separator="-"
                        Text="数码-手机"
                        Watermark="只读模式">
                        <cy:CascadePickerItem Header="家电">
                            <cy:CascadePickerItem Header="大家电" />
                            <cy:CascadePickerItem Header="小家电" />
                        </cy:CascadePickerItem>
                        <cy:CascadePickerItem Header="数码">
                            <cy:CascadePickerItem Header="手机" />
                            <cy:CascadePickerItem Header="相机" />
                        </cy:CascadePickerItem>
                    </cy:CascadePicker>
                </cy:SpacingUniformGrid>
            </HeaderedContentControl>

            <!--  示例2：使用数据绑定的城市选择器  -->
            <HeaderedContentControl Header="城市选择器（使用 NodePathMemberPath）">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300" />
                        <ColumnDefinition Width="200" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <cy:CascadePicker
                        x:Name="CityPicker"
                        Grid.Column="0"
                        IsShowFullPath="True"
                        ItemsSource="{Binding CascadePicker.Cities}"
                        NodePathMemberPath="Name"
                        SelectedItem="{Binding CascadePicker.City}"
                        Separator="/"
                        Text="{Binding CascadePicker.Text}"
                        Watermark="请选择城市">
                        <cy:CascadePicker.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                <TextBlock Text="{Binding Name}" />
                            </HierarchicalDataTemplate>
                        </cy:CascadePicker.ItemTemplate>
                    </cy:CascadePicker>
                    <Button
                        Grid.Column="1"
                        Margin="10,0"
                        Command="{Binding CascadePicker.GetCityCommand}"
                        Content="获取选中城市" />
                    <TextBlock
                        Grid.Column="2"
                        VerticalAlignment="Center"
                        Text="{Binding ElementName=CityPicker, Path=SelectedItem.Name, StringFormat='当前选择: {0}'}" />
                </Grid>
            </HeaderedContentControl>

            <!--  示例3：同时使用 ItemTemplate 和 NodePathMemberPath  -->
            <HeaderedContentControl Header="商品分类选择器（ItemTemplate + NodePathMemberPath）">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="350" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <cy:CascadePicker
                        Grid.Column="0"
                        IsShowFullPath="True"
                        ItemsSource="{Binding CategoryPicker.Categories}"
                        NodePathMemberPath="Name"
                        SelectedItem="{Binding CategoryPicker.SelectedCategory}"
                        Separator=" &gt; "
                        Watermark="请选择商品分类">
                        <cy:CascadePicker.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding SubCategories}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock FontWeight="Bold" Text="{Binding Name}" />
                                    <TextBlock
                                        Margin="5,0,0,0"
                                        Foreground="Gray"
                                        Text="{Binding Description, StringFormat='({0})'}" />
                                </StackPanel>
                            </HierarchicalDataTemplate>
                        </cy:CascadePicker.ItemTemplate>
                    </cy:CascadePicker>
                    <Border
                        Grid.Column="1"
                        Margin="10,0,0,0"
                        Padding="10"
                        Background="LightGray"
                        CornerRadius="5">
                        <StackPanel>
                            <TextBlock Text="{Binding CategoryPicker.SelectedCategory.Name, StringFormat='分类: {0}', TargetNullValue='未选择'}" />
                            <TextBlock Text="{Binding CategoryPicker.SelectedCategory.Description, StringFormat='描述: {0}'}" />
                        </StackPanel>
                    </Border>
                </Grid>
            </HeaderedContentControl>

            <!--  示例4：不同的 NodePathMemberPath 设置  -->
            <HeaderedContentControl Header="不同的 NodePathMemberPath 设置">
                <cy:SpacingUniformGrid HorizontalSpacing="10" Rows="1">
                    <!--  使用 Name 作为路径  -->
                    <cy:CascadePicker
                        IsShowFullPath="True"
                        ItemsSource="{Binding CascadePicker.Cities}"
                        NodePathMemberPath="Name"
                        Separator=" - "
                        Watermark="使用 Name 属性">
                        <cy:CascadePicker.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                <TextBlock Text="{Binding Name}" />
                            </HierarchicalDataTemplate>
                        </cy:CascadePicker.ItemTemplate>
                    </cy:CascadePicker>

                    <!--  不设置 NodePathMemberPath，使用默认逻辑  -->
                    <cy:CascadePicker
                        IsShowFullPath="True"
                        ItemsSource="{Binding CascadePicker.Cities}"
                        Separator=" - "
                        Watermark="不设置（使用 ToString）">
                        <cy:CascadePicker.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                <TextBlock Text="{Binding Name}" />
                            </HierarchicalDataTemplate>
                        </cy:CascadePicker.ItemTemplate>
                    </cy:CascadePicker>
                </cy:SpacingUniformGrid>
            </HeaderedContentControl>

            <!--  示例5：使用复杂路径  -->
            <HeaderedContentControl Header="部门选择器（复杂路径：NodePathMemberPath='Info.Name'）">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="400" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <cy:CascadePicker
                        Grid.Column="0"
                        IsShowFullPath="True"
                        ItemsSource="{Binding DepartmentPicker.Departments}"
                        NodePathMemberPath="Info.Name"
                        SelectedItem="{Binding DepartmentPicker.SelectedDepartment}"
                        Separator=" / "
                        Watermark="请选择部门">
                        <cy:CascadePicker.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding SubDepartments}">
                                <Border Padding="2">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            FontFamily="Consolas"
                                            Foreground="DarkBlue"
                                            Text="{Binding Info.Code}" />
                                        <TextBlock
                                            Margin="5,0,0,0"
                                            FontWeight="Bold"
                                            Text="{Binding Info.Name}" />
                                    </StackPanel>
                                </Border>
                            </HierarchicalDataTemplate>
                        </cy:CascadePicker.ItemTemplate>
                    </cy:CascadePicker>
                    <StackPanel
                        Grid.Column="1"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center">
                        <TextBlock
                            FontSize="14"
                            FontWeight="Bold"
                            Text="选中的部门信息：" />
                        <TextBlock Text="{Binding DepartmentPicker.SelectedDepartment.Info.Name, StringFormat='部门名称: {0}', TargetNullValue='未选择'}" />
                        <TextBlock Text="{Binding DepartmentPicker.SelectedDepartment.Info.Code, StringFormat='部门代码: {0}'}" />
                    </StackPanel>
                </Grid>
            </HeaderedContentControl>

            <!--  示例6：混合使用各种特性  -->
            <HeaderedContentControl Header="综合示例">
                <cy:SpacingUniformGrid HorizontalSpacing="10" Rows="1">
                    <!--  只显示最后一级  -->
                    <cy:CascadePicker
                        IsShowFullPath="False"
                        ItemsSource="{Binding CategoryPicker.Categories}"
                        NodePathMemberPath="Name"
                        Separator=" - "
                        Watermark="只显示最后一级">
                        <cy:CascadePicker.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding SubCategories}">
                                <TextBlock Text="{Binding Name}" />
                            </HierarchicalDataTemplate>
                        </cy:CascadePicker.ItemTemplate>
                    </cy:CascadePicker>

                    <!--  使用部门代码作为路径  -->
                    <cy:CascadePicker
                        IsShowFullPath="True"
                        ItemsSource="{Binding DepartmentPicker.Departments}"
                        NodePathMemberPath="Info.Code"
                        Separator=" → "
                        Watermark="使用部门代码作为路径">
                        <cy:CascadePicker.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding SubDepartments}">
                                <TextBlock>
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}{0} ({1})">
                                            <Binding Path="Info.Name" />
                                            <Binding Path="Info.Code" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </HierarchicalDataTemplate>
                        </cy:CascadePicker.ItemTemplate>
                    </cy:CascadePicker>

                    <!--  不设置 NodePathMemberPath，使用默认 ToString  -->
                    <cy:CascadePicker
                        IsShowFullPath="True"
                        ItemsSource="{Binding CascadePicker.Cities}"
                        Separator=" | "
                        Watermark="不设置 NodePathMemberPath">
                        <cy:CascadePicker.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                <TextBlock Foreground="Green" Text="{Binding Name}" />
                            </HierarchicalDataTemplate>
                        </cy:CascadePicker.ItemTemplate>
                    </cy:CascadePicker>
                </cy:SpacingUniformGrid>
            </HeaderedContentControl>
        </cy:SpacingStackPanel>
    </ScrollViewer>
</UserControl>